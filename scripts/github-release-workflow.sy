let oses = [
	"linux",
	"macos",
]

let build_job = import "./lib/build-job.sy"
let create_release = import "./lib/create-release-job.sy"

let build_jobs = oses.fold((acc, os) => acc.merge({"build-${os}": build_job(os)}), {})
let release_job = {"create-release": create_release(oses)}

in

{
	name: "build-release"
	on: {
		push: {tags: '*'}
	}
	jobs: build_jobs.merge(release_job)
}
